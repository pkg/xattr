language: go
sudo: false

go:
  - "1.11.x" # Debian 10 "Buster"
  - "1.12.x" # Ubuntu 19.10
  - "1.13.x" # Debian 11 "Bullseye"
  - "1.14.x"
  - "1.15.x"
  - stable   # Latest Go release

os:
  - linux
  - osx
  - windows

before_install:
  - export GO111MODULE=on
  - go version
  - go get golang.org/x/tools/cmd/goimports

install:
  - go build

script:
  - ./.travis.sh
  # goimports on windows gives false positives
  - if [[ "${TRAVIS_OS_NAME}" != "windows" ]]; then diff <(goimports -d .) <(printf ""); fi

after_success:
  - bash <(curl -s https://codecov.io/bash)
